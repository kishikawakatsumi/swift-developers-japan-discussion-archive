<div class="chatlog__message-group">
  <div id="chatlog__message-container-1136516389331542016" class="chatlog__message-container" data-message-id="1136516389331542016">
    <div class="chatlog__message">
      <div class="chatlog__message-aside"><img class="chatlog__avatar" src="https://cdn.discordapp.com/guilds/291054398077927425/users/296270044306997259/avatars/b3c8f38318e72e64f46b20f15336336a.png?size=512" alt="Avatar" loading="lazy"></div>
      <div class="chatlog__message-primary">
        <div class="chatlog__header"><span class="chatlog__author" style="color:rgb(241,196,15)" title="d_date" data-user-id="296270044306997259">d_date</span> <a href="/channels/380329942505750529?category=コミュニティ&amp;channel=waiwai-swiftc&amp;message_id=1136516389331542016"><span class="chatlog__timestamp"></span></a><a href="#chatlog__message-container-1136516389331542016">08/03/2023 4:30 AM</a></div>
        <div class="chatlog__content chatlog__markdown"><span class="chatlog__markdown-preserve">話ずれてたらごめんだけど、TCAのスタイルが好みで、Protocol使わずに注入してます <code class="chatlog__markdown-pre chatlog__markdown-pre--multiline language-swift">public struct URLRoutingClient&lt;Route&gt; { var request: (Route) async throws -&gt; (Data, URLResponse) let decoder: JSONDecoder public init( request: @escaping (Route) async throws -&gt; (Data, URLResponse), decoder: JSONDecoder = .init() ) { self.request = request self.decoder = decoder }</code> live, noop, failingを用途に応じて差し替える <code class="chatlog__markdown-pre chatlog__markdown-pre--multiline language-swift"> public static func live&lt;R: ParserPrinter&gt;( router: R, session: URLSession = .shared, decoder: JSONDecoder = .init() ) -&gt; Self where R.Input == URLRequestData, R.Output == Route { Self.init( request: { route in let request = try router.request(for: route) return try await session.data(for: request) }, decoder: decoder ) } public static let noop = Self.init(request: { _ in try await Task.never() }) public static var failing: Self { Self { let message = """ Failed to respond to route: \(debugPrint($0)) Use '\(Self.self).override' to supply a default response for this route. """ XCTFail(message) throw UnimplementedEndpoint(message: message) } }</code></span></div>
      </div>
    </div>
  </div>
</div>