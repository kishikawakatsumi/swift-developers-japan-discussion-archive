<div class="chatlog__message-group">
  <div id="chatlog__message-container-630949678934130688" class="chatlog__message-container" data-message-id="630949678934130688">
    <div class="chatlog__message">
      <div class="chatlog__message-aside"><img class="chatlog__avatar" src="https://cdn.discordapp.com/avatars/189711109966659584/95280765d1be73ce985dce15ea3585f6.png?size=512" alt="Avatar" loading="lazy"></div>
      <div class="chatlog__message-primary">
        <div class="chatlog__header"><span class="chatlog__author" style="color:rgb(237,171,161)" title="omochimetaru" data-user-id="189711109966659584">omochimetaru</span> <a href="/channels/291211035438874625?category=archived&amp;channel=beginner-help_archived&amp;message_id=630951551711838228"><span class="chatlog__timestamp" title="Tuesday, October 8, 2019 2:08 AM"></span></a><a href="#chatlog__message-container-630949678934130688">10/8/2019 2:08 AM</a></div>
        <div class="chatlog__content chatlog__markdown"><span class="chatlog__markdown-preserve">１つ目のコードについては</span></div>
      </div>
    </div>
  </div>
  <div id="chatlog__message-container-630949769103278100" class="chatlog__message-container" data-message-id="630949769103278100">
    <div class="chatlog__message">
      <div class="chatlog__message-aside">
        <div class="chatlog__short-timestamp" title="Tuesday, October 8, 2019 2:09 AM">2:09 AM</div>
      </div>
      <div class="chatlog__message-primary">
        <div class="chatlog__content chatlog__markdown"><span class="chatlog__markdown-preserve">concurrentキューなので</span></div>
      </div>
    </div>
  </div>
  <div id="chatlog__message-container-630949847847010304" class="chatlog__message-container" data-message-id="630949847847010304">
    <div class="chatlog__message">
      <div class="chatlog__message-aside">
        <div class="chatlog__short-timestamp" title="Tuesday, October 8, 2019 2:09 AM">2:09 AM</div>
      </div>
      <div class="chatlog__message-primary">
        <div class="chatlog__content chatlog__markdown"><span class="chatlog__markdown-preserve">投入されるタスク同士は並行に動いちゃいます</span></div>
      </div>
    </div>
  </div>
  <div id="chatlog__message-container-630950077455663104" class="chatlog__message-container" data-message-id="630950077455663104">
    <div class="chatlog__message">
      <div class="chatlog__message-aside">
        <div class="chatlog__short-timestamp" title="Tuesday, October 8, 2019 2:10 AM">2:10 AM</div>
      </div>
      <div class="chatlog__message-primary">
        <div class="chatlog__content chatlog__markdown"><span class="chatlog__markdown-preserve">Dictionaryに対する並行アクセスが、readだけでも並行アクセスしても大丈夫なのかがそもそもわからないので、get側のsyncだけでも怪しい気はしますが、それは別にしても</span></div>
      </div>
    </div>
  </div>
  <div id="chatlog__message-container-630950236285829120" class="chatlog__message-container" data-message-id="630950236285829120">
    <div class="chatlog__message">
      <div class="chatlog__message-aside">
        <div class="chatlog__short-timestamp" title="Tuesday, October 8, 2019 2:10 AM">2:10 AM</div>
      </div>
      <div class="chatlog__message-primary">
        <div class="chatlog__content chatlog__markdown"><span class="chatlog__markdown-preserve">set側のasync(barrier)は、バリアされたタスク同士の同時実行を防ぐものなので <a href="https://developer.apple.com/documentation/dispatch/dispatchworkitemflags/1780674-barrier">https://developer.apple.com/documentation/dispatch/dispatchworkitemflags/1780674-barrier</a></span></div>
      </div>
    </div>
  </div>
  <div id="chatlog__message-container-630950301624434728" class="chatlog__message-container" data-message-id="630950301624434728">
    <div class="chatlog__message">
      <div class="chatlog__message-aside">
        <div class="chatlog__short-timestamp" title="Tuesday, October 8, 2019 2:11 AM">2:11 AM</div>
      </div>
      <div class="chatlog__message-primary">
        <div class="chatlog__content chatlog__markdown"><span class="chatlog__markdown-preserve"><s>書き込み操作同士は直列化されますが</s></span> <span class="chatlog__edited-timestamp" title="Tuesday, October 8, 2019 2:34 AM">(edited)</span></div>
      </div>
    </div>
  </div>
  <div id="chatlog__message-container-630950413868335104" class="chatlog__message-container" data-message-id="630950413868335104">
    <div class="chatlog__message">
      <div class="chatlog__message-aside">
        <div class="chatlog__short-timestamp" title="Tuesday, October 8, 2019 2:11 AM">2:11 AM</div>
      </div>
      <div class="chatlog__message-primary">
        <div class="chatlog__content chatlog__markdown"><span class="chatlog__markdown-preserve"><s>読み込み操作とは（多分）排他されないので</s></span> <span class="chatlog__edited-timestamp" title="Tuesday, October 8, 2019 2:34 AM">(edited)</span></div>
      </div>
    </div>
  </div>
  <div id="chatlog__message-container-630950468071325707" class="chatlog__message-container" data-message-id="630950468071325707">
    <div class="chatlog__message">
      <div class="chatlog__message-aside">
        <div class="chatlog__short-timestamp" title="Tuesday, October 8, 2019 2:11 AM">2:11 AM</div>
      </div>
      <div class="chatlog__message-primary">
        <div class="chatlog__content chatlog__markdown"><span class="chatlog__markdown-preserve"><s>Dictionaryに対して書き込みと読み込みを同時に行う可能性のあるコードになってます</s></span> <span class="chatlog__edited-timestamp" title="Tuesday, October 8, 2019 2:34 AM">(edited)</span></div>
      </div>
    </div>
  </div>
  <div id="chatlog__message-container-630950559066882068" class="chatlog__message-container" data-message-id="630950559066882068">
    <div class="chatlog__message">
      <div class="chatlog__message-aside">
        <div class="chatlog__short-timestamp" title="Tuesday, October 8, 2019 2:12 AM">2:12 AM</div>
      </div>
      <div class="chatlog__message-primary">
        <div class="chatlog__content chatlog__markdown"><span class="chatlog__markdown-preserve"><s>これは明確にDictionaryに対する違反なので暴走して未定義状態になってると思います。</s></span> <span class="chatlog__edited-timestamp" title="Tuesday, October 8, 2019 2:35 AM">(edited)</span></div>
      </div>
    </div>
  </div>
  <div id="chatlog__message-container-630950641971494928" class="chatlog__message-container" data-message-id="630950641971494928">
    <div class="chatlog__message">
      <div class="chatlog__message-aside">
        <div class="chatlog__short-timestamp" title="Tuesday, October 8, 2019 2:12 AM">2:12 AM</div>
      </div>
      <div class="chatlog__message-primary">
        <div class="chatlog__content chatlog__markdown"><span class="chatlog__markdown-preserve">２つ目のコードについては、デッドロックしてないと思います。</span></div>
      </div>
    </div>
  </div>
  <div id="chatlog__message-container-630950710346907659" class="chatlog__message-container" data-message-id="630950710346907659">
    <div class="chatlog__message">
      <div class="chatlog__message-aside">
        <div class="chatlog__short-timestamp" title="Tuesday, October 8, 2019 2:12 AM">2:12 AM</div>
      </div>
      <div class="chatlog__message-primary">
        <div class="chatlog__content chatlog__markdown"><span class="chatlog__markdown-preserve"><s>nを10000x1から10000x10まで順番に増加させていくと</s></span> <span class="chatlog__edited-timestamp" title="Tuesday, October 8, 2019 2:35 AM">(edited)</span></div>
      </div>
    </div>
  </div>
  <div id="chatlog__message-container-630950777963151370" class="chatlog__message-container" data-message-id="630950777963151370">
    <div class="chatlog__message">
      <div class="chatlog__message-aside">
        <div class="chatlog__short-timestamp" title="Tuesday, October 8, 2019 2:13 AM">2:13 AM</div>
      </div>
      <div class="chatlog__message-primary">
        <div class="chatlog__content chatlog__markdown"><span class="chatlog__markdown-preserve"><s>だんだん処理時間が増加していって、6,7,8ぐらいで急激に増加してました</s></span> <span class="chatlog__edited-timestamp" title="Tuesday, October 8, 2019 2:35 AM">(edited)</span></div>
      </div>
    </div>
  </div>
  <div id="chatlog__message-container-630950841771229204" class="chatlog__message-container" data-message-id="630950841771229204">
    <div class="chatlog__message">
      <div class="chatlog__message-aside">
        <div class="chatlog__short-timestamp" title="Tuesday, October 8, 2019 2:13 AM">2:13 AM</div>
      </div>
      <div class="chatlog__message-primary">
        <div class="chatlog__content chatlog__markdown"><span class="chatlog__markdown-preserve"><s>なので、x10のときも時間がかかってるだけに思います。</s></span> <span class="chatlog__edited-timestamp" title="Tuesday, October 8, 2019 2:35 AM">(edited)</span></div>
      </div>
    </div>
  </div>
  <div id="chatlog__message-container-630951037259218974" class="chatlog__message-container" data-message-id="630951037259218974">
    <div class="chatlog__message">
      <div class="chatlog__message-aside">
        <div class="chatlog__short-timestamp" title="Tuesday, October 8, 2019 2:14 AM">2:14 AM</div>
      </div>
      <div class="chatlog__message-primary">
        <div class="chatlog__content chatlog__markdown"><span class="chatlog__markdown-preserve"><s>急激に増加するのはおそらくDictionaryのrehashが発生するからだと思います。</s></span> <span class="chatlog__edited-timestamp" title="Tuesday, October 8, 2019 2:35 AM">(edited)</span></div>
      </div>
    </div>
  </div>
  <div id="chatlog__message-container-630951165697458187" class="chatlog__message-container" data-message-id="630951165697458187">
    <div class="chatlog__message">
      <div class="chatlog__message-aside">
        <div class="chatlog__short-timestamp" title="Tuesday, October 8, 2019 2:14 AM">2:14 AM</div>
      </div>
      <div class="chatlog__message-primary">
        <div class="chatlog__content chatlog__markdown"><span class="chatlog__markdown-preserve">ちなみに1つ目のコードに関しても、 個人的には書き込みをasyncで後回しにするのはあまりやらないほうが良いと思っていて</span></div>
      </div>
    </div>
  </div>
  <div id="chatlog__message-container-630951310857863168" class="chatlog__message-container" data-message-id="630951310857863168">
    <div class="chatlog__message">
      <div class="chatlog__message-aside">
        <div class="chatlog__short-timestamp" title="Tuesday, October 8, 2019 2:15 AM">2:15 AM</div>
      </div>
      <div class="chatlog__message-primary">
        <div class="chatlog__content chatlog__markdown"><span class="chatlog__markdown-preserve">その理由は、後回しにする事自体がDispatchQueue側のリソースを食うからです。</span></div>
      </div>
    </div>
  </div>
  <div id="chatlog__message-container-630951412880244736" class="chatlog__message-container" data-message-id="630951412880244736">
    <div class="chatlog__message">
      <div class="chatlog__message-aside">
        <div class="chatlog__short-timestamp" title="Tuesday, October 8, 2019 2:15 AM">2:15 AM</div>
      </div>
      <div class="chatlog__message-primary">
        <div class="chatlog__content chatlog__markdown"><span class="chatlog__markdown-preserve">めちゃくちゃたくさん使われるプリミティブなところでそういう処理を書くと、ちょっとしたスケジューリングのブレとかで、</span></div>
      </div>
    </div>
  </div>
  <div id="chatlog__message-container-630951474670731265" class="chatlog__message-container" data-message-id="630951474670731265">
    <div class="chatlog__message">
      <div class="chatlog__message-aside">
        <div class="chatlog__short-timestamp" title="Tuesday, October 8, 2019 2:15 AM">2:15 AM</div>
      </div>
      <div class="chatlog__message-primary">
        <div class="chatlog__content chatlog__markdown"><span class="chatlog__markdown-preserve">一瞬で10000タスクがDispatchQueueに乗って待機しちゃうことがありえます</span></div>
      </div>
    </div>
  </div>
  <div id="chatlog__message-container-630951551711838228" class="chatlog__message-container" data-message-id="630951551711838228">
    <div class="chatlog__message">
      <div class="chatlog__message-aside">
        <div class="chatlog__short-timestamp" title="Tuesday, October 8, 2019 2:16 AM">2:16 AM</div>
      </div>
      <div class="chatlog__message-primary">
        <div class="chatlog__content chatlog__markdown"><span class="chatlog__markdown-preserve">そうすると普通にそれだけの要素数の配列を読み書きするコストがDispatchQueue内部でかかるし、メモリも食うので、</span></div>
      </div>
    </div>
  </div>
</div>