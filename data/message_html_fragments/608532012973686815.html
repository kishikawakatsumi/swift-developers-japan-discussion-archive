<div class="chatlog__message-group">
  <div id="chatlog__message-container-608531959718871060" class="chatlog__message-container" data-message-id="608531959718871060">
    <div class="chatlog__message">
      <div class="chatlog__message-aside"><img class="chatlog__avatar" src="https://cdn.discordapp.com/avatars/291075091025100810/39d60f97ea2bca395f1992c42f25107c.png?size=512" alt="Avatar" loading="lazy"></div>
      <div class="chatlog__message-primary">
        <div class="chatlog__header"><span class="chatlog__author" style="color:rgb(155,89,182)" title="kishikawakatsumi#7600" data-user-id="291075091025100810">Kishikawa Katsumi</span> <a href="/channels/307001159565180928?category=開発環境, ライブラリ&amp;channel=uikit&amp;message_id=608532518655885312"><span class="chatlog__timestamp"></span></a><a href="#chatlog__message-container-608531959718871060">07-Aug-19 05:28 AM</a></div>
        <div class="chatlog__content chatlog__markdown"><span class="chatlog__markdown-preserve"><a href="https://github.com/kishikawakatsumi/IBPCollectionViewCompositionalLayout">https://github.com/kishikawakatsumi/IBPCollectionViewCompositionalLayout</a> iOS 13のCollection View Compositional LayoutsをiOS 12以前でも使えるように再実装したライブラリを書いています。 で、コードの互換性で困っていて（特にSwiftで使う場合）、 理想はDrop-in Replacementで、コードはそのままでiOS 10, 11, 12でも13でも動くのがやりたいです。 Objective-Cだけならなんとなくできそうな気がする、ただSwiftは同じコードだとXcode 11でビルド（iOS 13をBase SDK）したときに「このクラスはiOS 13からしか使えない〜」のチェックに引っかかって <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">if #available()</code> を書かないといけないです。そうすると結局２つのコードベースをメンテするのであまり嬉しくない。（そうは言ってもクラスが違うだけの同じコードになるから格段に楽ではある） 今考えているのはクラスにPrefixを付けて、それで書くようにしてもらって、iOS 13なら標準のAPIを、iOS 12以下ならライブラリのAPIにフォールバックする、という風にしようかと思いますがあまり気に入ってないので</span></div>
        <div class="chatlog__embed">
          <div class="chatlog__embed-color-pill" style="background-color:rgba(30,35,39,255)"></div>
          <div class="chatlog__embed-content-container">
            <div class="chatlog__embed-content">
              <div class="chatlog__embed-text">
                <div class="chatlog__embed-title"><a class="chatlog__embed-title-link" href="https://github.com/kishikawakatsumi/IBPCollectionViewCompositionalLayout">
                    <div class="chatlog__markdown chatlog__markdown-preserve">kishikawakatsumi/IBPCollectionViewCompositionalLayout</div>
                  </a></div>
                <div class="chatlog__embed-description">
                  <div class="chatlog__markdown chatlog__markdown-preserve">Backport of UICollectionViewCompositionalLayout to earlier iOS 12 - kishikawakatsumi/IBPCollectionViewCompositionalLayout</div>
                </div>
              </div>
              <div class="chatlog__embed-thumbnail-container"><a class="chatlog__embed-thumbnail-link" href="https://images-ext-1.discordapp.net/external/Sl75NRrgNRJ5lTskO6Z3vOd9QhTw9WMhAZFm8ZcfqVg/https/repository-images.githubusercontent.com/200871003/7c11ac80-b8e7-11e9-9629-471d225a1adf"> <img class="chatlog__embed-thumbnail" src="https://images-ext-1.discordapp.net/external/Sl75NRrgNRJ5lTskO6Z3vOd9QhTw9WMhAZFm8ZcfqVg/https/repository-images.githubusercontent.com/200871003/7c11ac80-b8e7-11e9-9629-471d225a1adf" alt="Thumbnail" loading="lazy"> </a></div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
  <div id="chatlog__message-container-608532012973686815" class="chatlog__message-container" data-message-id="608532012973686815">
    <div class="chatlog__message">
      <div class="chatlog__message-aside">
        <div class="chatlog__short-timestamp" title="07-Aug-19 05:28 AM">05:28</div>
      </div>
      <div class="chatlog__message-primary">
        <div class="chatlog__content chatlog__markdown"><span class="chatlog__markdown-preserve">もっと良い方法があったら教えてほしいです。</span></div>
      </div>
    </div>
  </div>
  <div id="chatlog__message-container-608532292415127563" class="chatlog__message-container" data-message-id="608532292415127563">
    <div class="chatlog__message">
      <div class="chatlog__message-aside">
        <div class="chatlog__short-timestamp" title="07-Aug-19 05:30 AM">05:30</div>
      </div>
      <div class="chatlog__message-primary">
        <div class="chatlog__content chatlog__markdown"><span class="chatlog__markdown-preserve">理想は <code class="chatlog__markdown-pre chatlog__markdown-pre--multiline nohighlight">let itemSize = NSCollectionLayoutSize(widthDimension: .fractionalWidth(1), heightDimension: .fractionalHeight(1)) let item = NSCollectionLayoutItem(layoutSize: itemSize) let groupSize = NSCollectionLayoutSize(widthDimension: .fractionalWidth(1), heightDimension: .absolute(44)) let group = NSCollectionLayoutGroup.horizontal(layoutSize: groupSize, subitems: [item]) let section = NSCollectionLayoutSection(group: group) let layout = UICollectionViewCompositionalLayout(section: section) let collectionView = UICollectionView(frame: .zero, collectionViewLayout: layout) ...</code> ^ これでiOS 13でも12以前でもうまく動く（iOS 13では標準のAPIを使う）。Xcode 10ならうまく動きそう。Xcode 11でビルドしようとするとダメ。 現在は妥協して以下のように書くようにしようかと考えています。</span> <span class="chatlog__edited-timestamp" title="07-Aug-19 05:31 AM">(edited)</span></div>
      </div>
    </div>
  </div>
  <div id="chatlog__message-container-608532518655885312" class="chatlog__message-container" data-message-id="608532518655885312">
    <div class="chatlog__message">
      <div class="chatlog__message-aside">
        <div class="chatlog__short-timestamp" title="07-Aug-19 05:30 AM">05:30</div>
      </div>
      <div class="chatlog__message-primary">
        <div class="chatlog__content chatlog__markdown"><span class="chatlog__markdown-preserve"><code class="chatlog__markdown-pre chatlog__markdown-pre--multiline nohighlight">let itemSize = IBPNSCollectionLayoutSize(widthDimension: .fractionalWidth(1), heightDimension: .fractionalHeight(1)) let item = IBPNSCollectionLayoutItem(layoutSize: itemSize) let groupSize = IBPNSCollectionLayoutSize(widthDimension: .fractionalWidth(1), heightDimension: .absolute(44)) let group = IBPNSCollectionLayoutGroup.horizontal(layoutSize: groupSize, subitems: [item]) let section = IBPNSCollectionLayoutSection(group: group) let layout = IBPUICollectionViewCompositionalLayout(section: section) let collectionView = UICollectionView(frame: .zero, collectionViewLayout: layout) ...</code>
            <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">IBP</code>プレフィックスをつける。美しくないし、あまり理解してもらえない気がする。</span></div>
      </div>
    </div>
  </div>
</div>