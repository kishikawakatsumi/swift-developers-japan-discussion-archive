<div class="chatlog__message-group">
  <div id="chatlog__message-container-653615423337660446" class="chatlog__message-container" data-message-id="653615423337660446">
    <div class="chatlog__message">
      <div class="chatlog__message-aside"><img class="chatlog__avatar" src="https://cdn.discordapp.com/avatars/407901312210960406/062f9f7cfa1dbd495c0da320c2971881.png?size=512" alt="Avatar" loading="lazy"></div>
      <div class="chatlog__message-primary">
        <div class="chatlog__header"><span class="chatlog__author" title="terumae1213" data-user-id="407901312210960406">やました</span> <a href="/channels/291211035438874625?category=archived&amp;channel=beginner-help_archived&amp;message_id=653615423337660446"><span class="chatlog__timestamp" title="Monday, December 9, 2019 3:14 PM"></span></a><a href="#chatlog__message-container-653615423337660446">12/9/2019 3:14 PM</a></div>
        <div class="chatlog__content chatlog__markdown"><span class="chatlog__markdown-preserve">初めまして質問させて頂く「やました」と言います！ よろしくお願いいたします！ 現在SNSアプリでよく見かける、リストの途中に動画が挟み込んで自動再生するUI（Twitterアプリを参考）を作成しています！ 以下の構成で作成しているのですが、動画セルを再利用した時に動画を途中から再生を行いたいのですが、Twitterアプリに比べると動画がスムーズ（URL設定→seekで指定時に側反映されないためDispatchで遅延処理をしている）に再生することができません...。 皆さんどうやってあんなにスムーズに途中から再生できてるんだ...！<img loading="lazy" class="chatlog__emoji " alt="🧐" title="face_with_monocle" src="https://cdn.jsdelivr.net/gh/twitter/twemoji@latest/assets/svg/1f9d0.svg"> 何か参考のサイトや、アドバイス頂けますと幸いです<img loading="lazy" class="chatlog__emoji " alt="🥺" title="pleading_face" src="https://cdn.jsdelivr.net/gh/twitter/twemoji@latest/assets/svg/1f97a.svg"> よろしくお願いいたします！ <code class="chatlog__markdown-pre chatlog__markdown-pre--multiline nohighlight"># 構成 ├── UITableView │ └── VideoCell（UITableViewCell継承のCustomClass） │ ├── currentTime（動画再生時間を保持するメンバ） │ ├── VideoView（UIView継承のCustomClass） │ │ └── AVPlayer │ │ └── AVPlayerItem │ │ └── AVPlayerLayer</code>
            <code class="chatlog__markdown-pre chatlog__markdown-pre--multiline nohighlight"># 作りたいもの Twitterアプリのタイムラインで表示される動画のUI # 機能 UITableView上で動画を再生・一時停止 　　1. スクロール時、動画のcellが画面内に収まっている場合は動画を再生 　　2. スクロール時、動画のcellが画面外に出ている場合は動画を一時停止 # やっている事 スクロール時に再生・一時停止の処理 　　1. ScrollViewのdelegate `scrollViewDidScroll` で最上部・最下部のCGPointを取得 　　2. 1で取得したCGPointからindexPathを取得 　　3. 2で取得したindexPathからcellを取得 　　4. 3で取得したcellのframeと画面上部、画面下部のcontentOffset.yを計算して、収まっている or 収まっていないを判定 　　5. 判定結果により、動画を再生 or 一時停止 # うまくいかない所 一度再生した動画セルが画面外に行き、再度画面内に来た時にスムーズに続きから再生されない 　　a. AVPlayerItemに動画URLを設定 　　b. AVPlayerのreplaceCurrentItemで設定 　　c. AVPlayerのseekで保持していた再生時間を指定（そのまま指定すると反応しない？のでDispatchで遅延実行しています）</code></span></div>
      </div>
    </div>
  </div>
</div>