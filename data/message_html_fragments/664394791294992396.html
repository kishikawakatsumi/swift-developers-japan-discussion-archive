<div class="chatlog__message-group">
  <div class="chatlog__author-avatar-container">
    <img class="chatlog__author-avatar" src="https://cdn.discordapp.com/avatars/127674083331538944/4893b43ea9ee2231b8ffb8b05c305ce3.png?size=128" alt="Avatar" loading="lazy">
  </div>
  <div class="chatlog__messages">
    <span class="chatlog__author-name" title="norio_nomura#8334" data-user-id="127674083331538944" style="color: rgb(155,89,182)">norio_nomura</span>
    <a href="/channels/430242233468452865?category=main&amp;channel=swiftbot-sandbox&amp;message_id=664395076642013214"><span class="chatlog__timestamp">08-Jan-20 09:07 AM</span></a>
    <div class="chatlog__message " data-message-id="664394791294992396" id="message-664394791294992396" title="Message sent: 08-Jan-20 09:07 AM">
      <div class="chatlog__content">
        <div class="markdown">
          <span class="preserve-whitespace">こんな感じにすると<span class="pre pre--inline">@convention(c)</span>使える。 <div class="pre pre--multiline language-swift">import Foundation public func isEqual(_ lhs: Any, _ rhs: Any) -&gt; Bool { let lhsType = type(of: lhs) let rhsType = type(of: rhs) guard lhsType == rhsType else { return false } guard let witnessTable = swift_conformsToProtocol(lhsType, EquatableProtocolDescriptor) else { return false } let theType = unsafeBitCast(lhsType, to: UnsafeRawPointer.self) return withUnsafePointer(to: lhs) { lhsPtr in withUnsafePointer(to: rhs) { rhsPtr in AnyEquatable_internalIsEqual(lhsPtr, rhsPtr, theType, witnessTable) } } } @_silgen_name("swift_conformsToProtocol") func swift_conformsToProtocol(_: Any.Type, _: UnsafeRawPointer) -&gt; UnsafeRawPointer? func load&lt;T&gt;(symbol: String) -&gt; T { if let sym = dlsym(dlopen(nil, RTLD_LAZY), symbol) { return unsafeBitCast(sym, to: T.self) } let errorString = String(validatingUTF8: dlerror()) fatalError("Finding symbol \(symbol) failed: \(errorString ?? "unknown error")") } let AnyEquatable_internalIsEqual: @convention(c) (UnsafeRawPointer, UnsafeRawPointer, UnsafeRawPointer, UnsafeRawPointer) -&gt; Bool = load(symbol: "AnyEquatable_internalIsEqual") let EquatableProtocolDescriptor: UnsafeRawPointer = load(symbol: "$sSQMp") @_silgen_name("AnyEquatable_internalIsEqual") func _internalIsEqual&lt;T: Equatable&gt;(_ lhs: T, rhs: T) -&gt; Bool { return lhs == rhs }</div></span>
          <span class="chatlog__edited-timestamp" title="08-Jan-20 09:41 AM">(edited)</span>
        </div>
      </div>
    </div>
    <div class="chatlog__message " data-message-id="664395076642013214" id="message-664395076642013214" title="Message sent: 08-Jan-20 09:08 AM">
      <div class="chatlog__content">
        <div class="markdown">
          <span class="preserve-whitespace">しかし、Linuxだとシンボル<span class="pre pre--inline">AnyEquatable_internalIsEqual</span>を見つけられないな。</span>
        </div>
      </div>
    </div>
  </div>
</div>