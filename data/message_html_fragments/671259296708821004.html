<div class="chatlog__message-group">
  <div class="chatlog__author-avatar-container">
    <img class="chatlog__author-avatar" src="https://cdn.discordapp.com/avatars/189711109966659584/95280765d1be73ce985dce15ea3585f6.png?size=128" alt="Avatar" loading="lazy">
  </div>
  <div class="chatlog__messages">
    <span class="chatlog__author-name" title="omochimetaru#1122" data-user-id="189711109966659584" style="color: rgb(237,171,161)">omochimetaru</span>
    <span class="chatlog__timestamp">27-Jan-20 07:37 AM</span>
    <div class="chatlog__message " data-message-id="671257406692524042" id="message-671257406692524042" title="Message sent: 27-Jan-20 07:37 AM">
      <div class="chatlog__content">
        <div class="markdown">
          <span class="preserve-whitespace">あーーなんか閃いてきた</span>
        </div>
      </div>
    </div>
    <div class="chatlog__message " data-message-id="671257720271273984" id="message-671257720271273984" title="Message sent: 27-Jan-20 07:38 AM">
      <div class="chatlog__content">
        <div class="markdown">
          <span class="preserve-whitespace">(移動中・・・</span>
        </div>
      </div>
    </div>
    <div class="chatlog__message " data-message-id="671258904121966602" id="message-671258904121966602" title="Message sent: 27-Jan-20 07:43 AM">
      <div class="chatlog__content">
        <div class="markdown">
          <span class="preserve-whitespace">
            <div class="pre pre--multiline language-swift">sequences.map { $0.first }</div>
          </span>
        </div>
      </div>
    </div>
    <div class="chatlog__message " data-message-id="671258963249201163" id="message-671258963249201163" title="Message sent: 27-Jan-20 07:43 AM">
      <div class="chatlog__content">
        <div class="markdown">
          <span class="preserve-whitespace">↑ここのmapに与えてる関数の型を考えたんですけど</span>
        </div>
      </div>
    </div>
    <div class="chatlog__message " data-message-id="671259092236369921" id="message-671259092236369921" title="Message sent: 27-Jan-20 07:43 AM">
      <div class="chatlog__content">
        <div class="markdown">
          <span class="preserve-whitespace">
            <div class="pre pre--multiline language-swift">&lt;T: Collection&gt;(_ x: T) -&gt; T.Element</div>
          </span>
          <span class="chatlog__edited-timestamp" title="27-Jan-20 07:44 AM">(edited)</span>
        </div>
      </div>
    </div>
    <div class="chatlog__message " data-message-id="671259204757225493" id="message-671259204757225493" title="Message sent: 27-Jan-20 07:44 AM">
      <div class="chatlog__content">
        <div class="markdown">
          <span class="preserve-whitespace">↑型としてはこのように書けると思います。</span>
        </div>
      </div>
    </div>
    <div class="chatlog__message " data-message-id="671259234062696449" id="message-671259234062696449" title="Message sent: 27-Jan-20 07:44 AM">
      <div class="chatlog__content">
        <div class="markdown">
          <span class="preserve-whitespace">で、何が引っかかっていたかと言うと</span>
        </div>
      </div>
    </div>
    <div class="chatlog__message " data-message-id="671259296708821004" id="message-671259296708821004" title="Message sent: 27-Jan-20 07:44 AM">
      <div class="chatlog__content">
        <div class="markdown">
          <span class="preserve-whitespace">今のSwiftでは関数型オブジェクト(クロージャ)は、 ジェネリックパラメータを取れないんです</span>
        </div>
      </div>
    </div>
    <div class="chatlog__message " data-message-id="671259337368535040" id="message-671259337368535040" title="Message sent: 27-Jan-20 07:44 AM">
      <div class="chatlog__content">
        <div class="markdown">
          <span class="preserve-whitespace">だから、まずそこを拡張する必要がある。</span>
        </div>
      </div>
    </div>
    <div class="chatlog__message " data-message-id="671259546143948800" id="message-671259546143948800" title="Message sent: 27-Jan-20 07:45 AM">
      <div class="chatlog__content">
        <div class="markdown">
          <span class="preserve-whitespace">次に</span>
        </div>
      </div>
    </div>
    <div class="chatlog__message " data-message-id="671259651270246411" id="message-671259651270246411" title="Message sent: 27-Jan-20 07:46 AM">
      <div class="chatlog__content">
        <div class="markdown">
          <span class="preserve-whitespace">ある多相な型関数 <span class="pre pre--inline">&lt;A&gt;(A) -&gt; B</span> を考えると</span>
        </div>
      </div>
    </div>
    <div class="chatlog__message " data-message-id="671259910016729088" id="message-671259910016729088" title="Message sent: 27-Jan-20 07:47 AM">
      <div class="chatlog__content">
        <div class="markdown">
          <span class="preserve-whitespace">あいや、 <span class="pre pre--inline">&lt;A&gt;(A) -&gt; &lt;B&gt;B</span> かもしれないんですけど</span>
        </div>
      </div>
    </div>
    <div class="chatlog__message " data-message-id="671259919680405554" id="message-671259919680405554" title="Message sent: 27-Jan-20 07:47 AM">
      <div class="chatlog__content">
        <div class="markdown">
          <span class="preserve-whitespace">この計算(AからBを求めること)を記述できる言語機能は</span>
        </div>
      </div>
    </div>
    <div class="chatlog__message " data-message-id="671259997971283969" id="message-671259997971283969" title="Message sent: 27-Jan-20 07:47 AM">
      <div class="chatlog__content">
        <div class="markdown">
          <span class="preserve-whitespace">多分 <span class="pre pre--inline">struct</span> に対するメンバの <span class="pre pre--inline">typealias</span> しかない。</span>
        </div>
      </div>
    </div>
    <div class="chatlog__message " data-message-id="671260061133176863" id="message-671260061133176863" title="Message sent: 27-Jan-20 07:47 AM">
      <div class="chatlog__content">
        <div class="markdown">
          <span class="preserve-whitespace">で、ただ、 <span class="pre pre--inline">&lt;A&gt;A</span> が多相なので</span>
        </div>
      </div>
    </div>
    <div class="chatlog__message " data-message-id="671260137884745732" id="message-671260137884745732" title="Message sent: 27-Jan-20 07:48 AM">
      <div class="chatlog__content">
        <div class="markdown">
          <span class="preserve-whitespace"><span class="pre pre--inline">&lt;A&gt;</span> に与えられる実際の型を規定するのが、</span>
        </div>
      </div>
    </div>
    <div class="chatlog__message " data-message-id="671260195523002371" id="message-671260195523002371" title="Message sent: 27-Jan-20 07:48 AM">
      <div class="chatlog__content">
        <div class="markdown">
          <span class="preserve-whitespace">言語機能としての <span class="pre pre--inline">protocol</span> だと思う。</span>
        </div>
      </div>
    </div>
    <div class="chatlog__message " data-message-id="671260538247970816" id="message-671260538247970816" title="Message sent: 27-Jan-20 07:49 AM">
      <div class="chatlog__content">
        <div class="markdown">
          <span class="preserve-whitespace">つまり、 <span class="pre pre--inline">&lt;A&gt;(A) -&gt; &lt;B&gt;B</span> は <span class="pre pre--inline">protocol AP { associatedtype R }</span> なときに、 <span class="pre pre--inline">&lt;A: AP&gt;(A) -&gt; R</span> な式が持ってる型。</span>
        </div>
      </div>
    </div>
    <div class="chatlog__message " data-message-id="671260899776135178" id="message-671260899776135178" title="Message sent: 27-Jan-20 07:51 AM">
      <div class="chatlog__content">
        <div class="markdown">
          <span class="preserve-whitespace">普通のクロージャ構文だと、 <span class="pre pre--inline">$0</span> って書いた時点でもうなんらかの <span class="pre pre--inline">T</span> としてのコンパイルになっちゃってクロージャも <span class="pre pre--inline">(T) -&gt; U</span> になるけど、 そうじゃなくて <span class="pre pre--inline">&lt;A: P&gt;(A) -&gt; U</span> のほうにならないといけない。</span>
        </div>
      </div>
    </div>
    <div class="chatlog__message " data-message-id="671261023814025236" id="message-671261023814025236" title="Message sent: 27-Jan-20 07:51 AM">
      <div class="chatlog__content">
        <div class="markdown">
          <span class="preserve-whitespace">でそれがあると、</span>
        </div>
      </div>
    </div>
    <div class="chatlog__message " data-message-id="671261303708581888" id="message-671261303708581888" title="Message sent: 27-Jan-20 07:52 AM">
      <div class="chatlog__content">
        <div class="markdown">
          <span class="preserve-whitespace">動的なタプルの場合は動的な処理としてさっきのmapが動かせて</span>
        </div>
      </div>
    </div>
    <div class="chatlog__message " data-message-id="671261360486875137" id="message-671261360486875137" title="Message sent: 27-Jan-20 07:52 AM">
      <div class="chatlog__content">
        <div class="markdown">
          <span class="preserve-whitespace">もし入力元のタプルの型が静的にわかっているときは、</span>
        </div>
      </div>
    </div>
    <div class="chatlog__message " data-message-id="671261514682073130" id="message-671261514682073130" title="Message sent: 27-Jan-20 07:53 AM">
      <div class="chatlog__content">
        <div class="markdown">
          <span class="preserve-whitespace">静的解析で結果のタプルの型がわかる。</span>
        </div>
      </div>
    </div>
    <div class="chatlog__message " data-message-id="671261801207300098" id="message-671261801207300098" title="Message sent: 27-Jan-20 07:54 AM">
      <div class="chatlog__content">
        <div class="markdown">
          <span class="preserve-whitespace"><span class="pre pre--inline">$0.first</span> は、 <span class="pre pre--inline">$0</span> の型がわかっている(<span class="pre pre--inline">&lt;A&gt;(A) -&gt; B</span> の <span class="pre pre--inline">A</span> が特定できる)ときには、 <span class="pre pre--inline">.first</span> の型が静的にわかるけどそれは、 <span class="pre pre--inline">.first</span> の <span class="pre pre--inline">associatedtype</span> を与えているprotocolがあって、それを個別の <span class="pre pre--inline">A</span> が充足してる　<span class="pre pre--inline">typealias</span> が静的に見えるから、です。</span>
        </div>
      </div>
    </div>
    <div class="chatlog__message " data-message-id="671262234248216596" id="message-671262234248216596" title="Message sent: 27-Jan-20 07:56 AM">
      <div class="chatlog__content">
        <div class="markdown">
          <span class="preserve-whitespace">任意の <span class="pre pre--inline">x.y</span> の形の式に対して、 <span class="pre pre--inline">x</span> の型があるプロトコルで制約されていて、 <span class="pre pre--inline">y</span> がそのプロトコルのメンバなのであれば、 <span class="pre pre--inline">x.y</span> は静的に具体的な型が決定できる式、って事になりそう。</span>
        </div>
      </div>
    </div>
    <div class="chatlog__message " data-message-id="671262334572036106" id="message-671262334572036106" title="Message sent: 27-Jan-20 07:56 AM">
      <div class="chatlog__content">
        <div class="markdown">
          <span class="preserve-whitespace"><span class="pre pre--inline">x</span> だけのときは <span class="pre pre--inline">&lt;A&gt;(A) -&gt; A</span> まあつまり <span class="pre pre--inline">&lt;Self&gt;(Self) -&gt; Self</span>として同じことが言える。</span>
        </div>
      </div>
    </div>
    <div class="chatlog__message " data-message-id="671262624255836170" id="message-671262624255836170" title="Message sent: 27-Jan-20 07:58 AM">
      <div class="chatlog__content">
        <div class="markdown">
          <span class="preserve-whitespace">式が複雑になって？そうじゃないものが式の中に混ざり込んだ時は、静的に決定できない式になって、 タプルのmapとしては、全部の要素の型が同じタプルになっちゃう。</span>
        </div>
      </div>
    </div>
    <div class="chatlog__message " data-message-id="671262706849939457" id="message-671262706849939457" title="Message sent: 27-Jan-20 07:58 AM">
      <div class="chatlog__content">
        <div class="markdown">
          <span class="preserve-whitespace">そうじゃないものって存在しない気がするな？</span>
        </div>
      </div>
    </div>
    <div class="chatlog__message " data-message-id="671263159536975873" id="message-671263159536975873" title="Message sent: 27-Jan-20 08:00 AM">
      <div class="chatlog__content">
        <div class="markdown">
          <span class="preserve-whitespace">必ず何らかの式の型はあるから型は決定できるけど、 <span class="pre pre--inline">&lt;A&gt;(A) -&gt; B</span> の <span class="pre pre--inline">B</span> が　<span class="pre pre--inline">&lt;A&gt;</span> を充足する個別の <span class="pre pre--inline">T</span> に対して静的に解決できる型の場合と <span class="pre pre--inline">&lt;A&gt;</span> に入る <span class="pre pre--inline">T</span> がなんであろうが固定の型になっちゃう場合 ( <span class="pre pre--inline">description($0)</span> など )がある。</span>
        </div>
      </div>
    </div>
    <div class="chatlog__message " data-message-id="671263419684356116" id="message-671263419684356116" title="Message sent: 27-Jan-20 08:01 AM">
      <div class="chatlog__content">
        <div class="markdown">
          <span class="preserve-whitespace">この、個別に異なりえて、かつそれが静的に決定できる場合と、 そうでなくて固定になっちゃう場合が、またなんかちゃんと述べられる気がする。</span>
        </div>
      </div>
    </div>
    <div class="chatlog__message " data-message-id="671263514244939796" id="message-671263514244939796" title="Message sent: 27-Jan-20 08:01 AM">
      <div class="chatlog__content">
        <div class="markdown">
          <span class="preserve-whitespace">やっぱ　<span class="pre pre--inline">&lt;A&gt;(A) -&gt; &lt;B&gt;B</span> と <span class="pre pre--inline">&lt;A&gt;(A) -&gt; B</span> の違いなんじゃないか？？</span>
        </div>
      </div>
    </div>
    <div class="chatlog__message " data-message-id="671264056350605334" id="message-671264056350605334" title="Message sent: 27-Jan-20 08:03 AM">
      <div class="chatlog__content">
        <div class="markdown">
          <span class="preserve-whitespace">なぜなら、 map に <span class="pre pre--inline">&lt;A&gt;(A) -&gt; B</span> を与えたらそりゃ結果は <span class="pre pre--inline">(B, B, B, ...) </span> でしか無いはずなので。</span>
        </div>
      </div>
    </div>
    <div class="chatlog__message " data-message-id="671264232016314369" id="message-671264232016314369" title="Message sent: 27-Jan-20 08:04 AM">
      <div class="chatlog__content">
        <div class="markdown">
          <span class="preserve-whitespace">で、結果の型は、呼び出し側から決定できるわけじゃないから、リバースジェネリックパラメータがあるってことになりそう。</span>
        </div>
      </div>
    </div>
  </div>
</div>