<div class="chatlog__message-group">
  <div class="chatlog__author-avatar-container">
    <img class="chatlog__author-avatar" src="https://cdn.discordapp.com/avatars/293624673265123328/accd07acc220a18568ba46a6e9ede18a.png?size=128" alt="Avatar" loading="lazy">
  </div>
  <div class="chatlog__messages">
    <span class="chatlog__author-name" title="koher#9336" data-user-id="293624673265123328" style="color: rgb(17,128,106)">koher</span>
    <span class="chatlog__timestamp">23-Sep-21 02:22 PM</span>
    <div class="chatlog__message " data-message-id="890604077250129970" id="message-890604077250129970" title="Message sent: 23-Sep-21 02:22 PM">
      <div class="chatlog__content">
        <div class="markdown">
          <span class="preserve-whitespace">actor-isolated な context を引き継ぐ条件がよくわからなくなってきました・・・。 <span class="pre pre--inline">@MainActor</span> な API で↓を実行したときに、 <div class="pre pre--multiline language-swift">print("#0", Thread.current, Thread.current == Thread.main) Task { print("#1a", Thread.current, Thread.current == Thread.main) Task { print("#1b", Thread.current, Thread.current == Thread.main) } } task { print("#2a", Thread.current, Thread.current == Thread.main) Task { print("#2b", Thread.current, Thread.current == Thread.main) } } Task.detached { print("#3a", Thread.current, Thread.current == Thread.main) Task { print("#3b", Thread.current, Thread.current == Thread.main) } } taskDetached { print("#4a", Thread.current, Thread.current == Thread.main) Task { print("#4b", Thread.current, Thread.current == Thread.main) } } DispatchQueue.main.async { print("#5a", Thread.current, Thread.current == Thread.main) Task { print("#5b", Thread.current, Thread.current == Thread.main) } } dispatchQueueMainAsync { print("#6a", Thread.current, Thread.current == Thread.main) Task { print("#6b", Thread.current, Thread.current == Thread.main) } } DispatchQueue.global().async { print("#7a", Thread.current, Thread.current == Thread.main) Task { print("#7b", Thread.current, Thread.current == Thread.main) } } dispatchQueueGlobalAsync { print("#8a", Thread.current, Thread.current == Thread.main) Task { print("#8b", Thread.current, Thread.current == Thread.main) } }</div></span>
        </div>
      </div>
    </div>
    <div class="chatlog__message " data-message-id="890604224902201364" id="message-890604224902201364" title="Message sent: 23-Sep-21 02:23 PM">
      <div class="chatlog__content">
        <div class="markdown">
          <span class="preserve-whitespace">（なお、 <span class="pre pre--inline">task</span> などはそれとペアにある <span class="pre pre--inline">Task { }</span> などをただラップしただけの関数です。）</span>
        </div>
      </div>
    </div>
    <div class="chatlog__message " data-message-id="890604313578184725" id="message-890604313578184725" title="Message sent: 23-Sep-21 02:23 PM">
      <div class="chatlog__content">
        <div class="markdown">
          <span class="preserve-whitespace">結果は↓のようになりました。 <div class="pre pre--multiline nohighlight">#0 &lt;_NSMainThread: 0x6000035f4000&gt;{number = 1, name = main} true #1a &lt;_NSMainThread: 0x6000035f4000&gt;{number = 1, name = main} true #1b &lt;_NSMainThread: 0x6000035f4000&gt;{number = 1, name = main} true #2a &lt;NSThread: 0x6000035eac00&gt;{number = 6, name = (null)} false #2b &lt;NSThread: 0x6000035eac00&gt;{number = 6, name = (null)} false #3a &lt;NSThread: 0x6000035f6500&gt;{number = 4, name = (null)} false #3b &lt;NSThread: 0x6000035f6500&gt;{number = 4, name = (null)} false #4a &lt;NSThread: 0x6000035fc4c0&gt;{number = 5, name = (null)} false #4b &lt;NSThread: 0x6000035fc4c0&gt;{number = 5, name = (null)} false #5a &lt;_NSMainThread: 0x6000035f4000&gt;{number = 1, name = main} true #5b &lt;_NSMainThread: 0x6000035f4000&gt;{number = 1, name = main} true #6a &lt;_NSMainThread: 0x6000035f4000&gt;{number = 1, name = main} true #6b &lt;_NSMainThread: 0x6000035f4000&gt;{number = 1, name = main} true #7a &lt;NSThread: 0x600003571780&gt;{number = 8, name = (null)} false #7b &lt;_NSMainThread: 0x6000035f4000&gt;{number = 1, name = main} true #8a &lt;NSThread: 0x6000035b2440&gt;{number = 3, name = (null)} false #8b &lt;_NSMainThread: 0x6000035f4000&gt;{number = 1, name = main} true</div></span>
        </div>
      </div>
    </div>
    <div class="chatlog__message " data-message-id="890604485574000701" id="message-890604485574000701" title="Message sent: 23-Sep-21 02:24 PM">
      <div class="chatlog__content">
        <div class="markdown">
          <span class="preserve-whitespace">1b, 5b, 6b, 7b, 8b のみ context が引き継がれている。</span>
        </div>
      </div>
    </div>
    <div class="chatlog__message " data-message-id="890604816705933382" id="message-890604816705933382" title="Message sent: 23-Sep-21 02:25 PM">
      <div class="chatlog__content">
        <div class="markdown">
          <span class="preserve-whitespace">1b が OK なのに 2b は context が引き継がれず、にも関わらず 8b は引き継がれているのとか謎じゃないでしょうか。</span>
        </div>
      </div>
      <div class="chatlog__reactions">
        <div class="chatlog__reaction" title="eyes">
          <img class="emoji emoji--small" alt="👀" src="https://twemoji.maxcdn.com/2/svg/1f440.svg" loading="lazy">
          <span class="chatlog__reaction-count">1</span>
        </div>
      </div>
    </div>
  </div>
</div>