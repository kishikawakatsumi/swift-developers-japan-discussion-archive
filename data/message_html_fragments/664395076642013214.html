<div class="chatlog__message-group">
  <div id="chatlog__message-container-664394791294992396" class="chatlog__message-container" data-message-id="664394791294992396">
    <div class="chatlog__message">
      <div class="chatlog__message-aside"><img class="chatlog__avatar" src="https://cdn.discordapp.com/avatars/127674083331538944/4893b43ea9ee2231b8ffb8b05c305ce3.png?size=512" alt="Avatar" loading="lazy"></div>
      <div class="chatlog__message-primary">
        <div class="chatlog__header"><span class="chatlog__author" style="color:rgb(155,89,182)" title="norio_nomura" data-user-id="127674083331538944">norio_nomura</span> <a href="/channels/430242233468452865?category=main&amp;channel=swiftbot-sandbox&amp;message_id=664395076642013214"><span class="chatlog__timestamp" title="Wednesday, 08 January 2020 09:07"></span></a><a href="#chatlog__message-container-664394791294992396">01/08/2020 09:07</a></div>
        <div class="chatlog__content chatlog__markdown"><span class="chatlog__markdown-preserve">こんな感じにすると<code class="chatlog__markdown-pre chatlog__markdown-pre--inline">@convention(c)</code>使える。 <code class="chatlog__markdown-pre chatlog__markdown-pre--multiline language-swift">import Foundation public func isEqual(_ lhs: Any, _ rhs: Any) -&gt; Bool { let lhsType = type(of: lhs) let rhsType = type(of: rhs) guard lhsType == rhsType else { return false } guard let witnessTable = swift_conformsToProtocol(lhsType, EquatableProtocolDescriptor) else { return false } let theType = unsafeBitCast(lhsType, to: UnsafeRawPointer.self) return withUnsafePointer(to: lhs) { lhsPtr in withUnsafePointer(to: rhs) { rhsPtr in AnyEquatable_internalIsEqual(lhsPtr, rhsPtr, theType, witnessTable) } } } @_silgen_name("swift_conformsToProtocol") func swift_conformsToProtocol(_: Any.Type, _: UnsafeRawPointer) -&gt; UnsafeRawPointer? func load&lt;T&gt;(symbol: String) -&gt; T { if let sym = dlsym(dlopen(nil, RTLD_LAZY), symbol) { return unsafeBitCast(sym, to: T.self) } let errorString = String(validatingUTF8: dlerror()) fatalError("Finding symbol \(symbol) failed: \(errorString ?? "unknown error")") } let AnyEquatable_internalIsEqual: @convention(c) (UnsafeRawPointer, UnsafeRawPointer, UnsafeRawPointer, UnsafeRawPointer) -&gt; Bool = load(symbol: "AnyEquatable_internalIsEqual") let EquatableProtocolDescriptor: UnsafeRawPointer = load(symbol: "$sSQMp") @_silgen_name("AnyEquatable_internalIsEqual") func _internalIsEqual&lt;T: Equatable&gt;(_ lhs: T, rhs: T) -&gt; Bool { return lhs == rhs }</code></span> <span class="chatlog__edited-timestamp" title="Wednesday, 08 January 2020 09:41">(edited)</span></div>
      </div>
    </div>
  </div>
  <div id="chatlog__message-container-664395076642013214" class="chatlog__message-container" data-message-id="664395076642013214">
    <div class="chatlog__message">
      <div class="chatlog__message-aside">
        <div class="chatlog__short-timestamp" title="Wednesday, 08 January 2020 09:08">09:08</div>
      </div>
      <div class="chatlog__message-primary">
        <div class="chatlog__content chatlog__markdown"><span class="chatlog__markdown-preserve">しかし、Linuxだとシンボル<code class="chatlog__markdown-pre chatlog__markdown-pre--inline">AnyEquatable_internalIsEqual</code>を見つけられないな。</span></div>
      </div>
    </div>
  </div>
</div>