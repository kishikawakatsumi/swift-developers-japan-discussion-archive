<div class="chatlog__message-group">
  <div class="chatlog__author-avatar-container">
    <img class="chatlog__author-avatar" src="https://cdn.discordapp.com/avatars/131342384406462464/cf965ca79d511a1b6806c08ea5bccc1c.png?size=128" alt="Avatar" loading="lazy">
  </div>
  <div class="chatlog__messages">
    <span class="chatlog__author-name" title="たけし#4224" data-user-id="131342384406462464" style="">たけし</span>
    <a href="/channels/763427634179735592/959045924213112832?category=atcoder&amp;channel=algo-848&amp;message_id=959302184267300894"><span class="chatlog__timestamp">01-Apr-22 04:01 AM</span></a>
    <div class="chatlog__message " data-message-id="959301497781383208" id="message-959301497781383208" title="Message sent: 01-Apr-22 04:01 AM">
      <div class="chatlog__content">
        <div class="markdown">
          <span class="preserve-whitespace">遅くなってしまったのですが、bmp[r] を先にnilとしても、aとbはnilにはならないのではないでしょうか。（そもそもオプショナルではない？） また、仮にそうなったとしたら、bmp[nil]となってしまい、エラーとなってしまいます。 そこでWAは別の原因があるのではないかと、試行錯誤してみました。 quesera2さんのおっしゃったように原因が追いにくのでご確認いただけると幸いです。 入力 <div class="pre pre--multiline nohighlight">3 5 0 1 2 0 2 1 1 2 1 1 0 1 0</div> 期待する出力 <div class="pre pre--multiline nohighlight">Yes Yes Yes</div>
            <span class="pre pre--inline">1 -&gt; 2 -&gt; 1</span>の状態に<span class="pre pre--inline">Contract(2)</span>とすることで<span class="pre pre--inline">1 -&gt; 1</span>になります。 そこに<span class="pre pre--inline">Contract(1)</span>とすることで連結がなくなるはずなのですが、<a href="https://algo-method.com/submissions/372068">こちらの提出では</a> その後に代入をすることで<span class="pre pre--inline">1 -&gt; 1</span>の状態に戻ってしまいます。 そのため、続く<span class="pre pre--inline">Connect(1, 0)</span>で連結ができずに、<span class="pre pre--inline">Error</span>を出力してしまいます。 スレッドでも触れていた <span class="pre pre--inline">a==b</span>はこの解決が目的だったと思うのですが、今度は <span class="pre pre--inline">1 -&gt; 1</span> の自己参照にならなくなっています。 入力 <div class="pre pre--multiline nohighlight">3 4 0 1 2 0 2 1 1 2 0 1 0</div> 期待する出力 <div class="pre pre--multiline nohighlight">Yes Yes Error</div> 再度、<span class="pre pre--inline">1 -&gt; 2 -&gt; 1</span>の状態で <span class="pre pre--inline">Contract(2)</span> とした際に上記と同様に、 <span class="pre pre--inline">1 -&gt; 1</span>となることが期待されます。 しかし、<a href="https://algo-method.com/submissions/372092">こちらの提出</a> では<span class="pre pre--inline">bmp[1]</span>も<span class="pre pre--inline">bmp[a] = (prev: nil, next: nil)</span>で、連結がない状態となります。 そのため、<span class="pre pre--inline">Connect(1, 0)</span>の際に <span class="pre pre--inline">Error</span> となりません。 そこで下記のように<span class="pre pre--inline">a==r</span>として自己参照か判別し、何もせずに <span class="pre pre--inline">break</span> することでACすることができました。 <a href="https://algo-method.com/submissions/372562">https://algo-method.com/submissions/372562</a></span>
          <span class="chatlog__edited-timestamp" title="01-Apr-22 04:05 AM">(edited)</span>
        </div>
      </div>
      <div class="chatlog__reactions">
        <div class="chatlog__reaction" title="t_tensai">
          <img class="emoji emoji--small" alt="t_tensai" src="https://cdn.discordapp.com/emojis/892024054138163221.png" loading="lazy">
          <span class="chatlog__reaction-count">1</span>
        </div>
        <div class="chatlog__reaction" title="pray">
          <img class="emoji emoji--small" alt="🙏" src="https://twemoji.maxcdn.com/2/svg/1f64f.svg" loading="lazy">
          <span class="chatlog__reaction-count">1</span>
        </div>
      </div>
    </div>
    <div class="chatlog__message " data-message-id="959302184267300894" id="message-959302184267300894" title="Message sent: 01-Apr-22 04:04 AM">
      <div class="chatlog__content">
        <div class="markdown">
          <span class="preserve-whitespace">改めてみると長いですね…。申し訳ありません！（今後はgistとかの方が良いでしょうか？）</span>
        </div>
      </div>
    </div>
  </div>
</div>